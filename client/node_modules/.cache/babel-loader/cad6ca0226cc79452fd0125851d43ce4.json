{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dagnygudmundsdottir/tests/secured-router/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dagnygudmundsdottir/tests/secured-router/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dagnygudmundsdottir/tests/secured-router/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect,Suspense}from\"react\";import axios from\"axios\";import{Link,Router,Route}from\"react-router-dom\";var LazyLoaded=/*#__PURE__*/React.lazy(function(){return import(\"./LazyLoaded\");});function View(props){var screen=props.screen,setScreen=props.setScreen;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),box=_useState2[0],showBox=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var deleteCookie=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/clear-cookie\");case 3:setScreen(\"auth\");_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function deleteCookie(){return _ref.apply(this,arguments);};}();var getData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"/get-data\");case 3:res=_context2.sent;console.log(res.data);setData(res.data);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function getData(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:box?/*#__PURE__*/_jsx(LazyLoaded,{}):null}),/*#__PURE__*/_jsx(Link,{to:\"/protected\",children:/*#__PURE__*/_jsx(\"p\",{children:\"To protected\"})}),/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Route,{path:\"/protected\"})}),/*#__PURE__*/_jsx(\"p\",{children:screen}),/*#__PURE__*/_jsx(\"p\",{children:data}),/*#__PURE__*/_jsx(\"button\",{onClick:getData,children:\"Get Data\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return showBox(!box);},children:\"Show Red box\"}),/*#__PURE__*/_jsx(\"button\",{onClick:deleteCookie,children:\"Logout\"})]});}function App(){var _useState5=useState(\"auth\"),_useState6=_slicedToArray(_useState5,2),screen=_useState6[0],setScreen=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),username=_useState8[0],setUsername=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),password=_useState10[0],setPassword=_useState10[1];var auth=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get(\"/authenticate\",{auth:{username:username,password:password}});case 3:res=_context3.sent;if(res.data.screen!==undefined){setScreen(res.data.screen);}_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function auth(){return _ref3.apply(this,arguments);};}();var readCookie=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"/read-cookie\");case 3:res=_context4.sent;if(res.data.screen!==undefined){setScreen(res.data.screen);}_context4.next=11;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);setScreen(\"auth\");console.log(_context4.t0);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function readCookie(){return _ref4.apply(this,arguments);};}();useEffect(function(){readCookie();},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:screen===\"auth\"?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username: \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Password: \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:auth,children:\"Login\"})]}):/*#__PURE__*/_jsx(View,{screen:screen,setScreen:setScreen})});}export default App;","map":{"version":3,"sources":["/Users/dagnygudmundsdottir/tests/secured-router/client/src/App.js"],"names":["React","useState","useEffect","Suspense","axios","Link","Router","Route","LazyLoaded","lazy","View","props","screen","setScreen","box","showBox","data","setData","deleteCookie","get","console","log","getData","res","App","username","setUsername","password","setPassword","auth","undefined","readCookie","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Suspense } from \"react\";\nimport axios from \"axios\";\nimport { Link, Router, Route } from \"react-router-dom\";\n\nconst LazyLoaded = React.lazy(() => import(\"./LazyLoaded\"));\n\nfunction View(props) {\n  const { screen, setScreen } = props;\n  const [box, showBox] = useState(false);\n  const [data, setData] = useState();\n\n  const deleteCookie = async () => {\n    try {\n      await axios.get(\"/clear-cookie\");\n      setScreen(\"auth\");\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const getData = async () => {\n    try {\n      const res = await axios.get(\"/get-data\");\n      console.log(res.data);\n      setData(res.data);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  return (\n    <div>\n      <Suspense fallback={<div>Loading...</div>}>\n        {box ? <LazyLoaded /> : null}\n      </Suspense>\n      <Link to=\"/protected\">\n        <p>To protected</p>\n      </Link>\n      <Router>\n        <Route path=\"/protected\"></Route>\n      </Router>\n      <p>{screen}</p>\n      <p>{data}</p>\n\n      <button onClick={getData}>Get Data</button>\n      <button onClick={() => showBox(!box)}>Show Red box</button>\n      <button onClick={deleteCookie}>Logout</button>\n    </div>\n  );\n}\n\nfunction App() {\n  const [screen, setScreen] = useState(\"auth\");\n  const [username, setUsername] = useState();\n  const [password, setPassword] = useState();\n\n  const auth = async () => {\n    try {\n      const res = await axios.get(\"/authenticate\", {\n        auth: { username, password },\n      });\n\n      if (res.data.screen !== undefined) {\n        setScreen(res.data.screen);\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const readCookie = async () => {\n    try {\n      const res = await axios.get(\"/read-cookie\");\n\n      if (res.data.screen !== undefined) {\n        setScreen(res.data.screen);\n      }\n    } catch (e) {\n      setScreen(\"auth\");\n      console.log(e);\n    }\n  };\n\n  useEffect(() => {\n    readCookie();\n  }, []);\n\n  return (\n    <div className=\"App\">\n      {screen === \"auth\" ? (\n        <div>\n          <label>Username: </label>\n          <br />\n          <input type=\"text\" onChange={(e) => setUsername(e.target.value)} />\n          <br />\n          <label>Password: </label>\n          <br />\n          <input\n            type=\"password\"\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          <br />\n          <button onClick={auth}>Login</button>\n        </div>\n      ) : (\n        <View screen={screen} setScreen={setScreen} />\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}