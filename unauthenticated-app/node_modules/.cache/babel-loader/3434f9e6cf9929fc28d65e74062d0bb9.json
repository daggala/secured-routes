{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dagnygudmundsdottir/test/secured-routes/login-page/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dagnygudmundsdottir/test/secured-routes/login-page/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dagnygudmundsdottir/test/secured-routes/login-page/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState}from\"react\";import axios from\"axios\";import{useHistory}from\"react-router-dom\";function LoginForm(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var history=useHistory();var getPrivateApp=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/protected\");case 3:res=_context.sent;if(res.status===200){//Even though we're already at /protected path\n//we have to reload in order to make a HTTP call\n//to be able to fetch the index file for the private SPA.\nwindow.location.reload();}else{window.location=\"http://localhost:5000/\";}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getPrivateApp(){return _ref.apply(this,arguments);};}();var auth=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;_context2.next=4;return axios.get(\"/authenticate\",{auth:{username:username,password:password}});case 4:res=_context2.sent;if(res.status===200){//we're using history here to relocate the user, but without\n//making a new HTTP call\nhistory.push(\"/protected\");getPrivateApp();}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function auth(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:auth,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username: \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Password: \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"})]})});}export default LoginForm;","map":{"version":3,"sources":["/Users/dagnygudmundsdottir/test/secured-routes/login-page/src/LoginForm.js"],"names":["React","useState","axios","useHistory","LoginForm","username","setUsername","password","setPassword","history","getPrivateApp","get","res","status","window","location","reload","console","log","auth","e","preventDefault","push","target","value"],"mappings":"yfAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,QAASC,CAAAA,SAAT,EAAqB,eACaH,QAAQ,EADrB,wCACZI,QADY,eACFC,WADE,8BAEaL,QAAQ,EAFrB,yCAEZM,QAFY,eAEFC,WAFE,eAInB,GAAMC,CAAAA,OAAO,CAAGN,UAAU,EAA1B,CAEA,GAAMO,CAAAA,aAAa,0FAAG,iLAEAR,CAAAA,KAAK,CAACS,GAAN,CAAU,YAAV,CAFA,QAEZC,GAFY,eAGlB,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACtB;AACA;AACA;AACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACD,CALD,IAKO,CACLF,MAAM,CAACC,QAAP,CAAkB,wBAAlB,CACD,CAViB,+EAYlBE,OAAO,CAACC,GAAR,cAZkB,oEAAH,kBAAbR,CAAAA,aAAa,0CAAnB,CAgBA,GAAMS,CAAAA,IAAI,2FAAG,kBAAOC,CAAP,8HACXA,CAAC,CAACC,cAAF,GADW,wCAGSnB,CAAAA,KAAK,CAACS,GAAN,CAAU,eAAV,CAA2B,CAC3CQ,IAAI,CAAE,CAAEd,QAAQ,CAARA,QAAF,CAAYE,QAAQ,CAARA,QAAZ,CADqC,CAA3B,CAHT,QAGHK,GAHG,gBAMT,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACtB;AACA;AACAJ,OAAO,CAACa,IAAR,CAAa,YAAb,EACAZ,aAAa,GACd,CAXQ,mFAaTO,OAAO,CAACC,GAAR,eAbS,sEAAH,kBAAJC,CAAAA,IAAI,6CAAV,CAiBA,mBACE,YAAK,SAAS,CAAC,KAAf,uBACE,cAAM,QAAQ,CAAEA,IAAhB,wBACE,qCADF,cAEE,aAFF,cAGE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,kBAACC,CAAD,QAAOd,CAAAA,WAAW,CAACc,CAAC,CAACG,MAAF,CAASC,KAAV,CAAlB,EAA7B,EAHF,cAIE,aAJF,cAKE,qCALF,cAME,aANF,cAOE,cAAO,IAAI,CAAC,UAAZ,CAAuB,QAAQ,CAAE,kBAACJ,CAAD,QAAOZ,CAAAA,WAAW,CAACY,CAAC,CAACG,MAAF,CAASC,KAAV,CAAlB,EAAjC,EAPF,cAQE,aARF,cASE,eAAQ,IAAI,CAAC,QAAb,mBATF,GADF,EADF,CAeD,CAED,cAAepB,CAAAA,SAAf","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\";\n\nfunction LoginForm() {\n  const [username, setUsername] = useState();\n  const [password, setPassword] = useState();\n\n  const history = useHistory();\n\n  const getPrivateApp = async () => {\n    try {\n      const res = await axios.get(\"/protected\");\n      if (res.status === 200) {\n        //Even though we're already at /protected path\n        //we have to reload in order to make a HTTP call\n        //to be able to fetch the index file for the private SPA.\n        window.location.reload();\n      } else {\n        window.location = \"http://localhost:5000/\";\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const auth = async (e) => {\n    e.preventDefault();\n    try {\n      const res = await axios.get(\"/authenticate\", {\n        auth: { username, password },\n      });\n      if (res.status === 200) {\n        //we're using history here to relocate the user, but without\n        //making a new HTTP call\n        history.push(\"/protected\");\n        getPrivateApp();\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      <form onSubmit={auth}>\n        <label>Username: </label>\n        <br />\n        <input type=\"text\" onChange={(e) => setUsername(e.target.value)} />\n        <br />\n        <label>Password: </label>\n        <br />\n        <input type=\"password\" onChange={(e) => setPassword(e.target.value)} />\n        <br />\n        <button type=\"submit\">Login</button>\n      </form>\n    </div>\n  );\n}\n\nexport default LoginForm;\n"]},"metadata":{},"sourceType":"module"}